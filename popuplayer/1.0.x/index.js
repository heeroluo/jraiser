/*!
 * JRaiser 2 Javascript Library
 * popuplayer - v1.0.0 (2013-03-28T15:43:03+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("popuplayer/1.0.x/",["base/1.0.x/","dom/1.0.x/dom-event-arg","widget/1.0.x/"],function(e,i,o){"use strict";var t=e("base/1.0.x/"),p=e("widget/1.0.x/");return p.create(function(e){var i=this,o=i._wrapper=e.wrapper;i._popupTrigger=o.find(".popup-trigger"),i._popupContent=o.find(".popup-content"),i._popupTrigger.length||(i._popupTrigger=o),i._popupContent.length||(i._popupContent=o)},{_init:function(e){var i=this;i.popup=function(){i._cancelCloseTimer(),i._visible!==!0&&i._doAction(!0)},i.close=function(){i._cancelCloseTimer();var o=function(){i._visible!==!1&&i._doAction(!1)};e.closeDelay?i._closeTimer=setTimeout(o,e.closeDelay):o()},i.toggle=function(){i._visible===!0?i.close():i.popup()},i._popupTrigger&&e.popupWhen&&(e.popupWhen===e.closeWhen?i._popupTrigger.on(e.popupWhen,i.toggle):i._popupTrigger.on(e.popupWhen,i.popup).on(e.closeWhen,i.close)),i._popupStyle=t.extend({},e.popupStyle),i._closedStyle=t.extend({},e.closedStyle),e.visible?i.popup():i.close()},_destroy:function(e){var i=this;i._popupTrigger&&i._popupTrigger.off(e.popupWhen,i.toggle).off(e.popupWhen,i.popup).off(e.closeWhen,i.close),delete i.toggle,delete i.popup,delete i.close,delete i._popupStyle,delete i._closedStyle,delete i._visible,i._cancelCloseTimer()},_cancelCloseTimer:function(){this._closeTimer&&(clearTimeout(this._closeTimer),delete this._closeTimer)},_computeStyle:function(e){var i=this,o=i._popupContent,t=i["_"+e],p=i._options[e];if("none"!==o.css("display")&&"hidden"===o.css("visibility")){var n,l=o.get(0);(""===p.width||""===p.height)&&(n={width:l.style.width,height:l.style.height,visibility:"hidden"},o.css({width:p.width,height:p.height,visibility:"visible"}),["width","height"].forEach(function(e){""===i._popupStyle[e]&&(t[e]=o[e]())}),o.css(n))}},_doAction:function(e){if(e!==this._visible){var i=this,o=i.trigger(e?"beforepopup":"beforeclose");if(!o.isDefaultPrevented()){var p=i._options.animation,n=e?"popupStyle":"closedStyle",l=i["_"+n];i._computeStyle(n),p?i._popupContent.animate(l,t.mix({callback:i._actionDone.bind(i,e)},p,{overwrite:!1})):(i._popupContent.css(l),i._actionDone(e))}}},_actionDone:function(e){this._visible=e,this.trigger(e?"aftershow":"afterclose")}},{wrapper:null,visible:!1,popupWhen:"mouseenter",closeWhen:"mouseleave",popupStyle:{width:"",height:"",visibility:"visible"},closedStyle:{width:0,height:0,visibility:"hidden"},animation:null,closeDelay:50})});