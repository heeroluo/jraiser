define("promise/1.2/promise-wrap",null,function(n,t,e){"use strict";var r=n("../../base/1.2/base").createClass(function(n){this._promise=new Promise(n)},{then:function(t,e){var i=this;return new r(function(n){n(i._promise.then(t,e))})},spread:function(t,e){var i=this;return new r(function(n){n(i._promise.then(function(n){return t.apply(this,n)},e))})},"catch":function(t){var e=this;return new r(function(n){n(e._promise["catch"](t))})},"finally":function(i){var n=this;return new r(function(t,e){n._promise.then(function(n){i.apply(this,arguments),t(n)},function(n){i.apply(this,arguments),e(n)})})}});["all","race","reject","resolve"].forEach(function(n){r[n]=Promise[n]}),e.exports=r});
define("promise/1.2/promise-sim",null,function(n,t,e){"use strict";var i=n("../../base/1.2/base"),r="undefined"!=typeof console&&"function"==typeof console.error?function(n){console.error("Uncaught (in promise) %o",n)}:function(n){throw n};function s(n,t,e){!function i(n){return n&&"function"==typeof n.then}(n)?t(n):n.then(t,e)}var f=i.createClass(function(n){if("function"!=typeof n)throw new Error("Executor must be a function");var t=this;function e(n){t._settle(2,n)}t._status=0,t._pendings={};try{n(function(n){s(n,function(n){t._settle(1,n)},e)},e)}catch(i){e(i)}},{_settle:function(t,e){var i=this;0===i._status&&(i._status=t,i._value=e,setTimeout(function(){if(2!==i._status||i._hasRejectedHandler){var n=i._pendings[t];n&&n.forEach(function(n){n(e)}),delete i._pendings}else r(e)},0))},_listen:function(n,t){var e=this;2===n&&(e._hasRejectedHandler=!0),e._pendings?(e._pendings[n]=e._pendings[n]||[],e._pendings[n].push(t)):e._status===n&&setTimeout(function(){t(e._value)},0)},_then:function(r,u,c){var o=this;return new f(function(e,i){o._listen(1,function(){var n=o._value;if(r)try{n=c&&Array.isArray(n)?r.apply(this,n):r.call(this,n)}catch(t){return void i(t)}s(n,e,i)}),o._listen(2,function(){var n=o._value;if(u){try{n=u.call(this,n)}catch(t){return void i(t)}s(n,e,i)}else i(n)})})},then:function(n,t){return this._then(n,t)},spread:function(n){return this._then(n,null,!0)},"catch":function(n){return this.then(null,n)},"finally":function(u){var c=this;return new f(function(i,r){function n(){var n,t=c._value;switch(c._status){case 1:n=function(){i(t)};break;case 2:n=function(){r(t)}}if(u)try{u()}catch(e){return void r(e)}n&&n()}c._listen(1,n),c._listen(2,n)})}});i.extend(f,{all:function(n){var u=n.length;return u?new f(function(e,i){var r=new Array(u);n.forEach(function(n,t){n.then(function(n){r[t]=n,--u||e(r)},i)})}):f.resolve([])},race:function(n){return new f(function(t,e){n.forEach(function(n){n.then(t,e)})})},resolve:function(e){return new f(function(n,t){s(e,n,t)})},reject:function(e){return new f(function(n,t){t(e)})}}),e.exports=f});
define("promise/1.2/promise",null,function(e,n,i){"use strict";var o;"undefined"!=typeof global?o=global.Promise:"undefined"!=typeof window&&(o=window.Promise),(o=e(o?"./promise-wrap":"./promise-sim")).series=function(e){return e.length?e.slice(1).reduce(function(e,n){return e.then(function(e){return n(e)})},e[0]()):o.resolve()},o.delay=function(n){return new o(function(e){setTimeout(e,n)})},i.exports=o});
define("timespan/1.0/timespan",null,function(e,r,t){"use strict";var n={SEC:1e3,MIN:6e4,HOUR:36e5,DAY:864e5,MONTH:2592e6,YEAR:31536e6},i=r.parse=function(e){if("number"==typeof e)return e;if(!isNaN(e))return Number(e);var r=parseFloat(e);if(isNaN(r))throw new Error("Invalid timespan string");var t=e.split(r)[1].trim().toUpperCase().replace(/S$/,"");if(n.hasOwnProperty(t))return r*n[t];throw new Error('Invalid time unit "'+t+'"')};r.addToDate=function(e,r){return new Date(("number"==typeof e?e:e.getTime())+i(r))}});
define("querystring/1.1/querystring",null,function(e,n,r){"use strict";var f=e("../../base/1.2/base");n.parse=function(e,t){if("string"!=typeof e)return{};t=f.extend({decode:decodeURIComponent},t);var o={};return e.split("&").forEach(function(e){if(e){e=e.split("=");var n=t.decode(e[0]),r=t.decode(e[1]||"");!r&&t.ignoreEmpty||(o.hasOwnProperty(n)?(Array.isArray(o[n])||(o[n]=[o[n]]),o[n].push(r)):o[n]=r)}}),o};var i=n.stringify=function(e,r){if("object"!=typeof e)return"";r=f.extend({encode:encodeURIComponent},r);var n,t,o=[];function i(e,n){null==n&&(n=""),""===n&&r.ignoreEmpty||o.push(r.encode(e)+"="+r.encode(n))}function c(e){i(n,e)}for(n in e)e.hasOwnProperty(n)&&(t=e[n],Array.isArray(t)?t.forEach(c):i(n,t));return o.join("&")};n.append=function(e,n,r){if(!("string"==typeof n&&""!==n||"object"==typeof n&&!f.isEmptyObject(n)))return e;var t=e.indexOf("#"),o="";return-1!==t&&(o=e.substring(t,e.length),e=e.substring(0,t)),e=e.replace(/[?&]$/,""),n="string"!=typeof n?i(n,r):n.replace(/^[?&]/,""),e+(-1!==e.indexOf("?")?"&":"?")+n+o}});
define("ajax/1.5/ajax",["base/1.2/base"],function(e,t,n){"use strict";var y=e("../../base/1.2/base"),o=e("../../promise/1.2/promise"),g=e("../../timespan/1.0/timespan"),w=e("../../querystring/1.1/querystring"),E=window,C=E.document,u=C.head||C.getElementsByTagName("head")[0],r="Cancel";function T(){var e=new Error(r);return e.isAJAXCancel=!0,e}var a="Timeout";function b(){var e=new Error(a);return e.isAJAXTimeout=!0,e}function i(o){return function(e,t){(t="function"==typeof t?{onload:t}:y.extend({},t)).timeout&&(t.timeout=g.parse(t.timeout));var n=y.extend({},t.data);t.nocache&&(n._=+new Date);for(var r=[e=w.append(e,n,{ignoreEmpty:!0}),t],a=2;a<arguments.length;a++)r.push(arguments[a]);return o.apply(this,r)}}var d="onload"in C.createElement("script")?"onload":"onreadystatechange",c=t.getScript=i(function(c,s,l){return new o(function(e,t){var n,r,a;function o(e){!a&&n&&(a=!0,n[d](),e&&t(e()))}l&&(E[l]=function(){a||e(y.toArray(arguments))}),n=C.createElement("script"),s.charset&&(n.charset=s.charset),n.async=!0,n[d]=function(){n&&(a||!n.readyState||/loaded|complete/.test(n.readyState))&&(n[d]=null,u.removeChild(n),n=null,r&&clearTimeout(r),l&&y.deleteGlobalVar(l),a||e())},n.src=c,u.firstChild?u.insertBefore(n,u.firstChild):u.appendChild(n),s.receiveCancel&&s.receiveCancel.call(E,function(){o(T)});var i=Number(s.timeout);0<i&&(r=setTimeout(function(){o(b)},i))})});var s=t.jsonp=function(e,t){var n;t=y.extend({},t);var r="POST"===String(t.method).toUpperCase();return/[?&]callback=([^&]+)/.test(e)?n=RegExp.$1:(n=t.callbackName||function i(e){var t=C.createElement("a");t.href=e;var n=t.pathname.split("/");n=(n[n.length-1]||"index").replace(/\.\w+$/,"");for(var r="jsonp_callback_"+(t.host+"_"+n).replace(/\W+/g,""),a=r,o=1;null!=E[a];)a=r+"_"+o++;return a}(e),r||(e=w.append(e,{callback:n}))),r?function a(p,m,v){return new o(function(e,t){var n,r,a,o;function i(){n&&(r.removeEventListener?r.removeEventListener("load",i,!1):r.detachEvent&&r.detachEvent("onload",i),n.parentNode&&n.parentNode.removeChild(n),n=r=null,a&&clearTimeout(a),v&&y.deleteGlobalVar(v),o||e())}function c(e){!o&&n&&(o=!0,i(),e&&t(e()))}v&&(E[v]=function(){o||e(y.toArray(arguments))}),(n=C.createElement("div")).style.display="none";var s=y.randomStr("form-target-");n.innerHTML='<form action="'+p+'" target="'+s+'" method="post"><input type="hidden" name="callback" value="'+v+'" /></form><iframe name="'+s+'" id="'+s+'"></iframe>';var l=n.firstChild;y.each(m.data,function f(e,t){Array.isArray(e)&&e.forEach(function(e){f(e,t)});var n=C.createElement("input");n.type="hidden",n.name=t,n.value=e,l.appendChild(n)});var u=C.body;u.firstChild?u.insertBefore(n,u.firstChild):u.appendChild(n),l.submit(),(r=l.nextSibling).addEventListener?r.addEventListener("load",i,!1):r.attachEvent&&r.attachEvent("onload",i),m.receiveCancel&&m.receiveCancel.call(E,function(){c(T)});var d=Number(g.parse(m.timeout||0));0<d&&(a=setTimeout(function(){c(b)},d))})}(e,t,n):c(e,t,n)},l={};t.getImage=i(function(r){var a=Math.random();return new o(function(e,t){var n=new Image;(l[a]=n).onload=function(){e(r)},n.onabort=n.onerror=function(){t(new Error("Failed to load image"))},n.src=r})["finally"](function(){delete l[a]})});var S=t.createXHR=E.XMLHttpRequest?function(){return new E.XMLHttpRequest}:function(){return new E.ActiveXObject("Microsoft.XMLHTTP")};var L=/(?:^|;\s*)(?:application|text)\/([a-z]+)/i;t.send=function(m,v){"string"!=typeof m&&(m=(v=m).url),v=v||{};var h=String(v.responseType||"").toLowerCase();return"jsonp"===h?s(m,v):new o(function(s,l){var u,d,f=S();function e(e){d||4===f.readyState||(f.abort(),d=!0,e&&l(e))}function t(){if(!d){var e=f.readyState,t=4===e?f.status:0;if(4===e&&t){var n,r,a;switch(u&&clearTimeout(u),h=h||function i(e){if(L.test(e))return RegExp.$1.toLowerCase()}(f.getResponseHeader("Content-Type"))){case"json":var o=(f.responseText||"").trim();if(o)try{n=JSON.parse(o)}catch(c){r="Invalid JSON format"}break;case"xml":(n=f.responseXML)&&n.documentElement||(r="Invalid XML format");break;default:n=f.responseText}!(200<=t&&t<300||1223===t||304===t)?((a=new Error("Error (HTTP status code: "+t+")")).code=t,a.data=n):r&&(a=new Error(r)),a?l(a):s(n)}}}var n=(v.method||"GET").toUpperCase(),r="boolean"!=typeof v.async||v.async,a=v.data,o=v.headers||{},i=String(v.requestType||"form").toLowerCase();if(a&&("json"===i?a=JSON.stringify(a):"string"!=typeof a&&(a=w.stringify(a,{ignoreEmpty:!0})),"GET"===n?(m=w.append(m,a),a=null):o["Content-Type"]=o["Content-Type"]||("json"===i?"application/json; charset=utf-8":"application/x-www-form-urlencoded; charset=utf-8")),v.nocache&&(m=w.append(m,{_:+new Date})),r){var c=Number(g.parse(v.timeout||0));0<c&&(u=setTimeout(function(){e(b)},c)),f.onreadystatechange=t,"onerror"in f&&(f.onerror=function(){u&&clearTimeout(u),d=!0,l(new Error("Network error"))})}v.username?f.open(n,m,r,v.username,v.password):f.open(n,m,r),function p(e){var t=C.createElement("div");t.innerHTML='<a href="'+e+'"></a>';var n=t.firstChild;n.href=n.href;var r=n.host!==E.location.host;return t=n=null,r}(m)&&(f.withCredentials=!!v.withCredentials),y.each(o,function(e,t){f.setRequestHeader(t,e)}),v.beforeSend&&v.beforeSend.call(E,f),f.send(a||""),v.receiveCancel&&v.receiveCancel.call(E,function(){e(T)}),r||t.call(f)})},t.serializeForm=function(e){if("nodeType"in e||"function"!=typeof e.get||(e=e.get(0)),"FORM"!==e.tagName)throw new Error("Form must be an HTML form element");var t,n,r,a,o={},i=e.elements,c=i.length;for(t=0;t<c;t++)r=(n=i[t]).name,!n.disabled&&r&&("INPUT"!==n.tagName||"radio"!==n.type&&"checkbox"!==n.type||n.checked)&&(a="password"===n.type?n.value:n.value.trim(),o.hasOwnProperty(r)?(Array.isArray(o[r])||(o[r]=[o[r]]),o[r].push(a)):o[r]=a);return o}});