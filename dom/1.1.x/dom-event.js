/*!
 * JRaiser 2 Javascript Library
 * dom-event - v1.1.0 (2014-12-15T10:35:06+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("dom/1.1.x/dom-event",["base/1.0.x/","dom/1.1.x/dom-base","dom/1.1.x/dom-data","dom/1.1.x/sizzle","dom/1.1.x/dom-event-arg",null],function(e){"use strict";function t(e){return s.isWindow(e)||s.isHTMLElement(e,!0)}function n(e){e=m.fix(e);var t=this,n=e.type,r=e.target;if(!(v.get(t,n)||r&&v.get(r,n))){var o=g[n]?g[n].bindType:n,a=y.get(t,o);a&&a.forEach(function(o){if(!e.isTrigger||o.trueType===n){var a;if(o.delegator){for(var i=r;i&&i!==t;){if(h.matchesSelector(i,o.delegator)){a=i,e.delegateTarget=t;break}i=i.parentNode}if(!a)return}else a=t;"data"in e||(e.data=o.data);var c=o.handle?o.handle.call(a,o,e):o.handler.call(a,e);c===!1&&e.preventDefault(),e.cancelBubble===!0&&e.stopPropagation()}})}}function r(e,n,r,o){t(e)&&n.forEach(function(t){var n=g[t];y.add(e,n?n.bindType:t,u.mix({handler:r,trueType:t,handle:n?n.handle:null},o,{overwrite:!1}))})}function o(e,n,r){t(e)&&(n?n.forEach(function(t){var n=g[t];y.remove(e,t,n?n.bindType:t,r)}):y.remove(e))}function a(e,r,o){if(t(e)&&r){o=o||{};var a=m.fix(u.extend({type:r,target:e},b[p[r]])),i=e,c=null!=o.bubbles?o.bubbles:E[r];a.isTrigger=!0,null!=o.data&&(a.data=o.data);do n.call(e,a),e=e.parentNode;while(c&&e&&!a.isPropagationStopped());w[r]&&!a.isDefaultPrevented()&&r in i&&(v.set(i,r,!0),i[r](),v.remove(i,r))}}var i,c,l,u=e("base/1.0.x/"),s=e("./dom-base"),f=e("./dom-data"),h=e("./sizzle"),d=e("./dom-event-arg");document.addEventListener?(i=function(e,t,n){e.addEventListener(t,n,!1)},c=function(e,t,n){e.removeEventListener(t,n,!1)}):document.attachEvent&&(i=function(e,t,n){e.attachEvent("on"+t,n)},c=function(e,t,n){e.detachEvent("on"+t,n)},l=!0);var p={},m={props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),keyHook:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHook:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement touches".split(" "),filter:function(e,t){var n,r,o,a=t.button,i=t.fromElement,c=t.touches;return c&&1===c.length&&(e.pageX=c[0].pageX,e.pageY=c[0].pageY),null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||document,r=n.documentElement,o=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||o&&o.scrollLeft||0)-(r&&r.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||o&&o.scrollTop||0)-(r&&r.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&i&&(e.relatedTarget=i===e.target?t.toElement:i),e.which||u.isUndefined(a)||(e.which=1&a?1:2&a?3:4&a?2:0),e}},fix:function(e){if(e instanceof d)return e;var t=e,n=this[p[e.type]+"Hook"],r=n&&n.props?this.props.concat(n.props):this.props;return e=u.mix(new d(e),t,{whiteList:r}),e.target||(e.target=t.srcElement||document),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,n&&n.filter?n.filter(e,t):e}},g={};"onmouseenter"in document||u.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){g[t]={bindType:e,handle:function(e,n){var r,o=n.relatedTarget;if(!n||!o||o!==this&&!h.contains(this,o)){var a=n.type;n.type=t,r=e.handler.call(this,n),n.type=a}return r}}});var v=f.createDataSpace({cloneable:!1}),y=function(){function e(e,r,o){var a;if(l){var a=function(){return n.apply(e,arguments)};o.set(e,t,a)}else a=n;i(e,r,a)}var t="__dispatch__",r=f.createDataSpace({onClone:function(n,r){var o;l&&(o=this.get(r,t)),this.keys(n).forEach(function(r){r!==t&&(o&&c(n,r,o),e(n,r,this))})}});return{add:function(n,o,a){if(o!==t){var i=r.get(n,o);i||(i=[],r.set(n,o,i),e(n,o,r)),i.push(a)}},get:function(e,t){return r.get(e,t)},remove:function(e,o,a,i){var l;if(i){var u=r.get(e,a);if(u){for(var s=u.length-1;s>=0;s--)u[s].trueType===o&&u[s].handler===i&&u.splice(s,1);u.length||(l=1)}}else l=o?1:2;var f=r.get(e,t)||n;1===l&&(r.remove(e,a),c(e,a,f));var h=r.keys(e);h&&(2===l?(h.forEach(function(n){n!==t&&c(e,n,f)}),h=null):1===h.length&&h[0]===t&&(h=null)),h||r.clear(e)}}}(),b={key:{view:window,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:0,charCode:0},mouse:{view:window,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0},ui:{view:window}},w={focus:!0,blur:!0,click:!0,reset:!0,submit:!0},E={scroll:!0,resize:!0,select:!0,error:!0,reset:!0,submit:!0,change:!0,abort:!0},k={on:function(e,t,n){return e=s.splitBySpace(e),e&&this.forEach(function(o){r(o,e,t,n)}),this},off:function(e,t){return e&&(e=s.splitBySpace(e)),this.forEach(function(n){o(n,e,t)}),this},trigger:function(e,t){return this.forEach(function(n){a(n,e,t)}),this}},T=/^key/,K=/^(?:mouse|contextmenu|touch)|click/;return"blur focus load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave touchstart touchmove touchend change select submit keydown keypress keyup error contextmenu".split(" ").forEach(function(e){T.test(e)?(E[e]=!0,p[e]="key"):K.test(e)&&(E[e]=!0,p[e]="mouse"),k[e]=function(t,n){return arguments.length?this.on(e,t,n):this.trigger(e)}}),{shortcuts:k}});