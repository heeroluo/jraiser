/*!
 * JRaiser 2 Javascript Library
 * regionselect - v1.0.0 (2014-08-24T13:37:43+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("regionselect/1.0.x/",["dom/1.0.x/","ajax/1.1.x/","widget/1.0.x/","tmpl/2.0.x/","uadetector/1.0.x/","draggable/1.0.x/","scrollbar/1.0.x/","selectmenu/1.0.x/"],function(e){"use strict";var n=e("base/1.0.x/"),t=(e("dom/1.0.x/"),e("ajax/1.1.x/")),c=e("widget/1.0.x/"),r=e("selectmenu/1.0.x/"),i=function(){var n,c=0,r=[];return function(i){2>c?(r.push(i),c||(t.jsonp(e.resolve("regionselect/data/1.x/provinces-and-cities").replace("-debug.js",".js"),{nocache:!1,callbackName:"jsonp_region_provincesAndCities",onsuccess:function(e){n=e,r.forEach(function(n){n.call(window,e)}),r=null,c=2}}),c=1)):i.call(window,n)}}(),o=function(){var n={},c={},r={};return function(i,o){var u=n[i]||0;if(2>u){var l=r[i]=r[i]||[];l.push(o),u||(t.jsonp(e.resolve("regionselect/data/1.x/counties-of-"+i).replace("-debug.js",".js"),{nocache:!1,callbackName:"jsonp_region_countiesOf"+i,onsuccess:function(e){c[i]=e,l.forEach(function(n){n.call(window,e)}),delete r[i],n[i]=2}}),n[i]=1)}else o.call(window,c[i])}}();return c.create(function(){},{_init:function(e){var t=this;t._specifiedValue={},e.value&&t.val(e.value),i(function(c){t._provinceSelect=new r(n.extend(e.province,{optionItems:c.map(function(n){return{text:n.name,value:n[e.valueType]}}),value:t._specifiedValue.province,events:{change:function(e){delete t._currentProvince,delete t._currentCity,delete t._currentCounty;for(var n=0;n<c.length;n++)if(c[n].code==e.newValue||c[n].name==e.newValue){t._currentProvince=c[n];break}t._options.city&&t._renderCities(t._currentProvince&&t._currentProvince.cities?t._currentProvince.cities:null),t._triggerChange()}}})),delete t._specifiedValue.province})},_destroy:function(){var e=this;e._provinceSelect&&e._provinceSelect.destroy(),e._citySelect&&e._citySelect.destroy(),e._countySelect&&e._countySelect.destroy(),delete e._currentProvince,delete e._currentCity,delete e._specifiedValue},_triggerChange:function(){var e=function(e){var n;return e&&(n={name:e.name,code:e.code},e.end&&(n.end=e.end)),n};this.trigger("change",{currentProvince:e(this._currentProvince),currentCity:e(this._currentCity),currentCounty:e(this._currentCounty)})},_renderCities:function(e){var t=this;t._citySelect&&t._citySelect.destroy(),e&&(t._citySelect=new r(n.extend(t._options.city,{optionItems:e.map(function(e){return{text:e.name,value:e[t._options.valueType]}}),value:t._specifiedValue.city,events:{change:function(e){delete t._currentCity,delete t._currentCounty;for(var n=t._currentProvince.cities,c=0;c<n.length;c++)if(n[c].code==e.newValue||n[c].name==e.newValue){t._currentCity=n[c];break}t._options.county&&(!t._currentCity||t._currentCity.end?t._renderCounties():t._renderCounties(t._currentProvince.code,t._currentCity.code)),t._triggerChange()}}})),delete t._specifiedValue.city),t._countySelect&&t._countySelect.destroy()},_renderCounties:function(e,t){var c=this;c._countySelect&&c._countySelect.destroy(),e&&t&&o(e,function(e){if(c._currentCity&&c._currentCity.code==t){var i=e[t];c._countySelect=new r(n.extend(c._options.county,{optionItems:i.map(function(e){return{text:e.name,value:e[c._options.valueType]}}),value:c._specifiedValue.county,events:{change:function(e){delete c._currentCounty;for(var n=0;n<i.length;n++)if(i[n].code==e.newValue||i[n].name==e.newValue){c._currentCounty=i[n];break}c._triggerChange()}}})),delete c._specifiedValue.county}})},val:function(e){var n=this;return arguments.length?(e.hasOwnProperty("city")&&(n._specifiedValue.city=e.city),e.hasOwnProperty("county")&&(n._specifiedValue.county=e.county),e.hasOwnProperty("province")&&(n._provinceSelect?n._provinceSelect.val(e.province):n._specifiedValue.province=e.province),void 0):{province:n._provinceSelect?n._provinceSelect.val():null,city:n._citySelect?n._citySelect.val():null,county:n._countySelect?n._countySelect.val():null}}},{valueType:"code"})});