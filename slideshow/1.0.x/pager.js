/*!
 * JRaiser 2 Javascript Library
 * slideshow-pager - v1.0.0 (2013-05-02T09:43:10+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("slideshow/1.0.x/pager",["dom/1.0.x/","widget/1.0.x/"],function(e,t,i){"use strict";var r=e("base/1.0.x/"),n=e("dom/1.0.x/"),_=e("widget/1.0.x/");return _.create(function(e){},{_init:function(e){var t=this,i=t._wrapper=e.wrapper,r=t._wrapper.children();if(t._itemSize=r.outerWidth(!0),t._total=r.length,t._totalItemSize=t._itemSize*t._total,t._itemNumberLimit=Math.floor(i.parent().innerWidth()/t._itemSize),t._itemNumberLimit){var _=t._itemNumberLimit-1;_%2?(t._widerSideNumber=Math.ceil(_/2),t._narrowerSideNumber=Math.floor(_/2),t._narrowerSideNumber>1&&(t._widerSideNumber+=1,t._narrowerSideNumber-=1)):(t._widerSideNumber=t._narrowerSideNumber=parseInt(_/2),t._narrowerSideNumber>2?(t._widerSideNumber+=2,t._narrowerSideNumber-=2):t._narrowerSideNumber>1&&(t._widerSideNumber+=1,t._narrowerSideNumber-=1));var l=r.clone(),o=r.clone();i.css("width",3*t._totalItemSize).prepend(l),i.append(o).css("left",-t._totalItemSize),t._itemCopies=[l,r,o],t._selectHandler=function(e){"click"===e.type&&e.preventDefault(),t.select(n(this).index(),e)},t._items=t._wrapper.children().on(e.selectWhen,t._selectHandler)}},_destroy:function(e){var t=this;delete t._itemSize,delete t._total,delete t._totalItemSize,delete t._itemNumberLimit,delete t._widerSideNumber,delete t._narrowerSideNumber,delete t._itemCopies,t._items.off(e.selectWhen,t._selectHandler),delete t._selectHandler,delete t._items},select:function(e,t){var i=this;i._triggerIndex=e,i.trigger("select",r.mix({newIndex:e%i._total,oldIndex:i._current},t,{overwrite:!1}))},activate:function(e){var t=this,i=e.newIndex;t._current!=i&&(t._items.forEach(function(e,r){r%t._total===i?n(e).addClass(t._options.currentItemClass):n(e).removeClass(t._options.currentItemClass)}),null!=t._current&&(t._scrollTo(t._triggerIndex,e.newIndex),delete t._triggerIndex),t._current=i)},next:function(e){this._scroll(e,1)},prev:function(e){this._scroll(e,0)},_scrollTo:function(e,t){var i,r,n,_,l=this,o=Math.abs(parseInt(l._wrapper.css("left"))),m=o/l._itemSize,a=m+l._itemNumberLimit-1;for(n=0;3>n;n++)if(_=l._current+l._total*n,_>=m&&a>=_){r=!0;break}if(r){if(null==e){for(n=0;3>n;n++)if(_=t+l._total*n,_>=m&&a>=_){e=_;break}i=parseInt((l._itemNumberLimit-1)/2)}m==e?e-=null!=i?l._itemNumberLimit-1-i:l._widerSideNumber:a==e?e-=i||l._narrowerSideNumber:e=null,null!=e&&l._doScrolling(-e*l._itemSize)}},_scroll:function(e,t){this._doScrolling(parseInt(this._wrapper.css("left"))+this._itemSize*(t?-e:e))},_doScrolling:function(e){var t=this;if(!t._moving){var i=t._wrapper,n=parseInt(i.css("left"));e>-t._totalItemSize?(i.css("left",n-t._totalItemSize).prepend(t._itemCopies[2]),e-=t._totalItemSize,t._itemCopies.unshift(t._itemCopies.pop())):e<-(2*t._totalItemSize-t._itemSize*t._itemNumberLimit)&&(i.css("left",n+t._totalItemSize).append(t._itemCopies[0]),e+=t._totalItemSize,t._itemCopies.push(t._itemCopies.shift())),t._moving=!0,i.animate({left:e},r.mix({callback:function(){delete t._moving}},t._options.animation,{overwrite:!1}))}}},{selectWhen:"click",currentItemClass:"slideshow-nav-current"})});