/*!
 * JRaiser 2 Javascript Library
 * slideshow-pager - v1.0.0 (2013-05-02T09:43:10+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("slideshow/1.0.x/pager",["dom/1.0.x/","widget/1.0.x/"],function(e){"use strict";var t=e("base/1.0.x/"),i=e("dom/1.0.x/"),r=e("widget/1.0.x/");return r.create(function(){},{_init:function(e){var t=this,r=t._wrapper=e.wrapper,n=t._wrapper.children();if(t._itemSize=n.outerWidth(!0),t._total=n.length,t._totalItemSize=t._itemSize*t._total,t._itemNumberLimit=Math.floor(r.parent().innerWidth()/t._itemSize),t._itemNumberLimit){var _=t._itemNumberLimit-1;_%2?(t._widerSideNumber=Math.ceil(_/2),t._narrowerSideNumber=Math.floor(_/2),t._narrowerSideNumber>1&&(t._widerSideNumber+=1,t._narrowerSideNumber-=1)):(t._widerSideNumber=t._narrowerSideNumber=parseInt(_/2),t._narrowerSideNumber>2?(t._widerSideNumber+=2,t._narrowerSideNumber-=2):t._narrowerSideNumber>1&&(t._widerSideNumber+=1,t._narrowerSideNumber-=1));var l=n.clone(),o=n.clone();r.css("width",3*t._totalItemSize).prepend(l),r.append(o).css("left",-t._totalItemSize),t._itemCopies=[l,n,o],t._selectHandler=function(e){"click"===e.type&&e.preventDefault(),t.select(i(this).index(),e)},t._items=t._wrapper.children().on(e.selectWhen,t._selectHandler)}},_destroy:function(e){var t=this;delete t._itemSize,delete t._total,delete t._totalItemSize,delete t._itemNumberLimit,delete t._widerSideNumber,delete t._narrowerSideNumber,delete t._itemCopies,t._items.off(e.selectWhen,t._selectHandler),delete t._selectHandler,delete t._items},select:function(e,i){var r=this;r._triggerIndex=e,r.trigger("select",t.mix({newIndex:e%r._total,oldIndex:r._current},i,{overwrite:!1}))},activate:function(e){var t=this,r=e.newIndex;t._current!=r&&(t._items.forEach(function(e,n){n%t._total===r?i(e).addClass(t._options.currentItemClass):i(e).removeClass(t._options.currentItemClass)}),null!=t._current&&(t._scrollTo(t._triggerIndex,e.newIndex),delete t._triggerIndex),t._current=r)},next:function(e){this._scroll(e,1)},prev:function(e){this._scroll(e,0)},_scrollTo:function(e,t){var i,r,n,_,l=this,o=Math.abs(parseInt(l._wrapper.css("left"))),m=o/l._itemSize,a=m+l._itemNumberLimit-1;for(n=0;3>n;n++)if(_=l._current+l._total*n,_>=m&&a>=_){r=!0;break}if(r){if(null==e){for(n=0;3>n;n++)if(_=t+l._total*n,_>=m&&a>=_){e=_;break}i=parseInt((l._itemNumberLimit-1)/2)}m==e?e-=null!=i?l._itemNumberLimit-1-i:l._widerSideNumber:a==e?e-=i||l._narrowerSideNumber:e=null,null!=e&&l._doScrolling(-e*l._itemSize)}},_scroll:function(e,t){this._doScrolling(parseInt(this._wrapper.css("left"))+this._itemSize*(t?-e:e))},_doScrolling:function(e){var i=this;if(!i._moving){var r=i._wrapper,n=parseInt(r.css("left"));e>-i._totalItemSize?(r.css("left",n-i._totalItemSize).prepend(i._itemCopies[2]),e-=i._totalItemSize,i._itemCopies.unshift(i._itemCopies.pop())):e<-(2*i._totalItemSize-i._itemSize*i._itemNumberLimit)&&(r.css("left",n+i._totalItemSize).append(i._itemCopies[0]),e+=i._totalItemSize,i._itemCopies.push(i._itemCopies.shift())),i._moving=!0,r.animate({left:e},t.mix({callback:function(){delete i._moving}},i._options.animation,{overwrite:!1}))}}},{selectWhen:"click",currentItemClass:"slideshow-nav-current"})});