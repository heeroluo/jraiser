/*!
 * JRaiser 2 Javascript Library
 * dom-event-proxy@1.1.0 (2016-06-16T15:41:07+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("widget/1.1.x/dom-event-proxy",["dom/1.1.x/"],function(e,n,t){"use strict";function i(e){if("string"==typeof e&&(e=e.trim().split(/\s+/)),e.length)return e}var r=e("base/1.1.x/"),c=e("dom/1.1.x/");return r.createClass(function(){this._init()},{_init:function(){this._elementRecords=[],this._eventRecords=[],this._handlerRecords={}},_createHandler:function(e){var n=this._handlerRecords;switch(typeof e){case"string":if(n[e])return n[e];throw new Error('handler "'+e+'" does not exist');case"function":e={fn:e};break;default:e={id:e.id,fn:e.fn}}if(e.id=e.id||r.randomStr(),n[e.id])throw new Error('handler "'+e+'" already exists');return e.counter=0,n[e.id]=e,e},on:function(e,n,t,r){var o=this._elementRecords,s=this._eventRecords,f=this._createHandler(t);return n=i(n),e.forEach(function(e){var t,i=o.indexOf(e);i===-1&&(i=o.push(e)-1,s[i]={}),t=s[i],e=c(e),n.forEach(function(n){t[n]=t[n]||{},t[n][f.id]||(t[n][f.id]=!0,f.counter++,e.on(n,f.fn,r))})}),this},off:function(e,n,t){var o=this._elementRecords,s=this._eventRecords,f=this._handlerRecords;arguments.length?(n&&(n=i(n)),e.forEach(function(e){var t=o.indexOf(e);t!==-1&&(e=c(e),r.each(s[t],function(i,c){n&&n.indexOf(c)===-1||(r.each(i,function(n,t){var r=f[t];e.off(c,r.fn),delete i[t],--r.counter<=0&&delete f[t]}),r.isEmptyObject(i)&&delete s[t][c])}),r.isEmptyObject(s[t])&&(o.splice(t,1),s.splice(t,1)))})):(o.forEach(function(e,n){e=c(e),r.each(s[n],function(n,t){r.each(n,function(n,i){e.off(t,f[i].fn)})})}),this._init())}})});