/*!
 * JRaiser 2 Javascript Library
 * calendar - v1.1.0 (2015-06-16T14:53:59+0800)
 * http://jraiser.org/ | Released under MIT license
 */
define("calendar/1.1.x/",["dom/1.1.x/","tmpl/2.1.x/","widget/1.1.x/"],function(e,t,a){"use strict";function n(e){var t=e.year,a=e.month,n=new Date(t,a-1,1),r=n.getDay(),o=["sun","mon","tues","wed","thur","fri","sat"];e=e||{},e.customTags&&!s.isArray(e.customTags)&&(e.customTags=[e.customTags]);var i=new Date(t,a-1,1-r).getTime();n.setMonth(a),n.setDate(0),r=n.getDay();var d,u,h,m,c=new Date(t,a-1,n.getDate()+6-r).getTime(),g={year:t,month:a,weeks:[]},y=864e5,l=new Date;for(l.setHours(0,0,0,0),l=l.getTime();c>=i;)d=new Date(i),h={year:d.getFullYear(),month:d.getMonth()+1,date:d.getDate(),day:d.getDay(),timestamp:i,tags:[]},h.tags.push("week-"+o[h.day]),h.tags.push(h.day>0&&h.day<6?"weekday":"weekend"),m=h.year<t||h.year===t&&h.month<a?"last-month":h.year>t||h.year===t&&h.month>a?"next-month":"current-month",h.tags.push(m),m=h.timestamp>l?"future":h.timestamp<l?"past":"today",h.tags.push(m),e.customTags&&s.merge(h.tags,e.customTags.map(function(e){return e(new Date(i))})),u&&7!==u.length||(u=[],g.weeks.push(u)),u.push(h),i+=y;return g}var s=e("base/1.1.x/"),r=e("dom/1.1.x/"),o=e("tmpl/2.1.x/"),i=e("widget/1.1.x/"),d=new o({table:'<table class="ui-calendar"<%-tableAttrs%>><% if (weekDayNames) { %><thead class="ui-calendar__head"><tr><% weekDayNames.forEach(function(name) { %><th class="ui-calendar__head__grid"><%=name%></span></th><% }); %></tr></thead><% } %><tbody class="ui-calendar__body"><% weeks.forEach(function(week) { %><tr><% week.forEach(function(dateObj) { %><td class="ui-calendar__body__date<% if (dateObj.tags) { %> <%=dateObj.tags.map(function(tag) { return "ui-calendar__body__date--" + tag; }).join(" ")%><% } %>""><%=dateObj.date%></td><% }); %></tr><% }); %></tbody></table>'}),u=/^([+-])(\d+)$/,h=i.create({_init:function(e){var t=new Date;this.year(e.year||t.getFullYear()),this.month(e.month||t.getMonth()+1)},_destroy:function(e){e.wrapper.empty()},render:function(e){var t=this,a=t._options;t._offDOMEvent(),e=e?s.extend({},e):n({year:t._year,month:t._month,customTags:a.customTags}),e.weekDayNames=a.weekDayNames,e.tableAttrs="",a.tableAttrs&&s.each(a.tableAttrs,function(t,a){e.tableAttrs+=" "+a+'="'+t+'"'});var o=r(d.render("table",e));t._onDOMEvent(o.find(".ui-calendar__body__date"),"click",function(n){n.preventDefault();var o=r(this),i=o.index(),d=o.parent().index(),u=e.weeks[d][i];t._trigger("dateselect",{sourceEvent:n,selectedDate:s.extend({dayName:a.weekDayNames[u.day]},u)})}),a.wrapper.html("").append(o),t._trigger("render",{table:o})},year:function(e){return arguments.length?void(this._year=u.test(e)?this._year+parseInt(e):parseInt(e)):this._year},month:function(e){if(!arguments.length)return this._month;var t=u.test(e)?this._month+parseInt(e):parseInt(e),a=new Date(this._year,t-1);this._year=a.getFullYear(),this._month=a.getMonth()+1}},{weekDayNames:"日一二三四五六".split("")});return h.buildModel=n,h});