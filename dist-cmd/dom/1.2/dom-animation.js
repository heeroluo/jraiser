define("dom/1.2/dom-animation",["base/1.2/base","promise/1.2/promise","tween/1.0/tween","dom/1.2/dom-base","dom/1.2/dom-data","dom/1.2/dom-style","dom/1.2/sizzle","dom/1.2/dom-offset"],function(e,t,n){"use strict";var r=e("../../base/1.2/base"),o=e("../../promise/1.2/promise"),u=e("../../tween/1.0/tween"),c=e("./dom-base"),s=e("./dom-data"),l=e("./dom-style"),f=e("./dom-offset"),a=/^[+-]?\d+(?:\.\d+)?[^\s]*$/,p=/^scroll(Top|Left)$/,h=/color$/i,i=/^#[0-9a-f]{6}$/i,d=/^rgb\((\d+),\s(\d+),\s(\d+)\)$/;function g(e,t){return"string"==typeof t&&(a.test(t)?t=parseFloat(t,10)||0:h.test(e)?i.test(t)?t=[parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)]:d.test(t)&&(t=[Number(RegExp.$1),Number(RegExp.$2),Number(RegExp.$3)]):t=t.toLowerCase()),t}var m=r.createClass(function(){this._queue=[],this._taskId=null},{add:function(e){this._queue.push(e),this.execNext()},stop:function(e,t){e&&(this._queue=[]),this._taskId&&(u.remove(this._taskId,t),this._taskId=null)},execNext:function(){var t=this;if(!t._taskId&&this._queue.length){var e=this._queue.shift();e.exec(function(e){t._taskId=e}).then(e.resolve,e.reject)["finally"](function(){t._taskId=null,t.execNext()})}}}),v=s.createDataSpace({cloneable:!1}),b="animationQueue";function x(r,a,i){return new o(function(e,t){if(c.isHTMLElement(r)){i=i||{};var n=v.get(r,b);n||(n=new m,v.set(r,b,n)),n.add({resolve:e,reject:t,exec:function(e){var t=function o(e,t){var n,r={};for(var s in t)t.hasOwnProperty(s)&&(n="width"===s||"height"===s?l.getSize(e,s):p.test(s)?f.getScroll(e,RegExp.$1):g(s,l.getStyle(e,s)),r[s]=n);return r}(r,a);return a=function s(e,t){var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=l.rRelNumber.test(e[n])?(parseFloat(t[n],10)||0)+Number(RegExp.$1+RegExp.$2):g(n,e[n]));return r}(a,t),u.create({startValue:t,endValue:a,duration:i.duration,easing:i.easing,receiveId:e,frame:function(e,t){p.test(t)?f.setScroll(r,RegExp.$1,e):l.setStyle(r,t,h.test(t)?"rgb("+e.map(function(e){return Math.min(255,Math.round(e))}).join(", ")+")":e)},onprogress:function(){i.onprogress&&i.onprogress.apply(r,arguments)}}).then(function(){i.oncomplete&&i.oncomplete.call(r)})}})}else e()})}t.shortcuts={animate:function(t,n,e){for(var r in"boolean"==typeof n&&(e=n,n=null),t)t.hasOwnProperty(r)&&(t[r]=g(r,t[r]));var s=o.all(this.map(function(e){return x(e,t,n)}));return e?s:(s["catch"](function(){}),this)},stop:function(t,n){return this.forEach(function(e){!function s(e,t,n){if(c.isHTMLElement(e)){var r=v.get(e,b);r&&(r.stop(t,n),t&&v.clear(e))}}(e,t,n)}),this}}});